/* -------------------------------------------------- */
/*   Variables                                        */
/* -------------------------------------------------- */

:root {
  --vae-border-color-temporary: rgba(158, 192, 255, 0.705);
  --vae-border-color-passive: rgba(255, 242, 167, 0.664);
  --vae-border-color-disabled: rgba(194, 0, 0, 0.61);
  --vae-dropshadow: drop-shadow(3px 3px 4px rgb(83, 83, 83));
  --vae-backdrop-color: rgb(49, 49, 49);
  --vae-button-color-font: rgba(255, 255, 255, 0.664);
  --vae-button-color-backdrop: rgb(100, 100, 100);
  --vae-name-color: rgb(255, 255, 255);
  --vae-name-border: 1px dashed rgba(133, 133, 133, 0.582);
  --vae-name-font: 'Amiri';
  --vae-tag-border: 1px solid rgb(197, 197, 197);
  --vae-tag-color-duration: rgba(100, 100, 255, 0.5);
  --vae-tag-color-disabled: rgba(255, 100, 100, 0.5);
  --vae-tag-color-source: rgba(255, 100, 255, 0.5);
}

/* -------------------------------------------------- */
/*   Panel                                            */
/* -------------------------------------------------- */

.visual-active-effects.panel {
  z-index: 100;
  filter: var(--vae-dropshadow);
  gap: calc(var(--visual-active-effects-icon-size) / 5);
  position: absolute;
  top: var(--visual-active-effects-top-offset);
  right: calc(var(--visual-active-effects-right-offset) + 16px * var(--ui-scale));
  transition: right 250ms ease;
  max-height: 100vh;
  display: flex;
  flex-direction: column;
  flex-wrap: wrap-reverse;

  #interface:has(#sidebar-content.expanded) & {
    /* hardcoded 300px because the variables are in the #sidebar element */
    right: calc(var(--visual-active-effects-right-offset) + 316px * var(--ui-scale));
  }

  .effect-item {
    cursor: var(--cursor-pointer);

    .effect-icon {
      background-size: contain;
      box-shadow: 0 0 0 1px silver;
      position: relative;
      transition: transform 0.15s;

      &.inactive {
        filter: brightness(0.25) grayscale(1);
      }

      .effect-icon-img {
        width: var(--visual-active-effects-icon-size);
        height: var(--visual-active-effects-icon-size);
        background-size: inherit;
        background-blend-mode: multiply; /* For tinting */
        mask-size: contain; /* For svgs to fit */
      }

      .badge {
        bottom: 5%;
        color: white;
        display: inline-block;
        left: 5%;
        position: absolute;
        text-shadow: 0 0 5px black;
        font-size: calc(var(--visual-active-effects-icon-size) / 3);
        pointer-events: none;

        &.unlimited {
          font-size: calc(var(--visual-active-effects-icon-size) / 4);
        }
        &.expired {
          color: orange;
        }
      }
    }
  }

  hr.divider {
    margin: .25em 0;
    width: var(--visual-active-effects-icon-size);
    display: none;
  }

  .effect-item + hr.divider:has( ~ .effect-item) {
    display: block;
  }
}

/* -------------------------------------------------- */
/*   Tooltip                                          */
/* -------------------------------------------------- */

#tooltip.visual-active-effects,
.locked-tooltip.visual-active-effects {
  padding: 0;
  overflow: hidden auto;
  max-width: var(--visual-active-effects-max-width);
  min-width: var(--visual-active-effects-max-width);
  filter: var(--vae-dropshadow);
  background-color: var(--vae-backdrop-color);
  border-left: 10px solid;

  &.temporary {
    border-color: var(--vae-border-color-temporary);
  }
  &.passive {
    border-color: var(--vae-border-color-passive);
  }
  &.disabled {
    border-color: var(--vae-border-color-disabled);
  }

  .effect-info-header {
    display: flex;
    flex-direction: column;
    padding-bottom: 4px;
    margin-bottom: 4px;

    &:not(:last-child) {
      border-bottom: var(--vae-name-border);
    }

    &:last-child {
      border: none;
    }

    .name {
      color: var(--vae-name-color);
      text-align: center;
      margin: .5rem;
      font-size: 1.2rem;
      font-family: var(--vae-name-font);
      text-transform: uppercase;
    }
  }

  .effect-intro {
    padding: 0.5rem 0.75rem;
    overflow: hidden auto;
    font-size: var(--visual-active-effects-font-size);
    line-height: normal;
  }

  .effect-tags {
    display: flex;
    gap: 3px;
    color: rgb(230, 230, 230);
    flex-wrap: wrap;
    justify-content: center;

    .effect-tag {
      border-radius: 5px;
      padding: .5rem;
      position: relative;
      white-space: nowrap;
      font-size: .75rem;
      font-family: Georgia, 'Times New Roman', Times, serif;

      &::after {
        content: "";
        position: absolute;
        inset: 1px;
        border-radius: 2px;
        border: var(--vae-tag-border);
      }

      &.temporary {
        background-color: var(--vae-tag-color-duration);
      }
      &.disabled {
        background-color: var(--vae-tag-color-disabled);
      }
      &.source {
        background-color: var(--vae-tag-color-source);
      }
    }
  }

  .vae-buttons {
    margin: 4px;
    display: grid;
    gap: 4px;
  }
}
